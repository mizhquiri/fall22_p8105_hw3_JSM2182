---
title: "Homework 3"
author: Jennifer Mizhquiri
output: github_document
---


```{r, echo = FALSE}
library(tidyverse)
library(ggridges)
library(patchwork)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Problem 1

Loaded instacart data
```{r, echo = FALSE}

library(p8105.datasets)
data("instacart")
```

## Problem 2

_Office Hours_ 
* how can i make leverage || , OR 
* how to load a promise object and view it...

```{r tidy_accel, echo = FALSE}
accel_df = 
  read_csv("./data/accel_data.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    weekend = if_else(day == "Saturday", 1, if_else(day == "Sunday", 1, 0))
  ) %>% 
  select(
    week, day_id, weekend, day, everything()
  ) %>%
  pivot_longer(
    activity_1:activity_1440,
    names_to = "min_24h",
    values_to = "activity_count",
    names_prefix = "activity_") %>% 
  mutate(
    min_24h = as.numeric(min_24h),
    weekend = as.logical(weekend),
    day = as.factor(day),
    day = factor(day, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>% 
  arrange(day_id, min_24h)

```

 
```{r}
head(accel_df)
```

There are `r nrow(accel_df)` observations. The variables in this dataset contain information on the sequential days (from days `r accel_df %>% pull(day_id) %>% min()` to `r accel_df %>% pull(day_id) %>% max()` and for each minute within each day). The accelerometer tracks activity which it quanitifies as activity counts. Based on the background information this is accelerometer data for a given individual diagnosed with CHD.

_officehours_ how to fix axis, coding, because weekend should be a logical variable so i changed that but geom_path makes it look like something taht is not continuous per se... what would be the best way to mayube aartificially change the axis. using geom_path and weekend as a continuous variable would have also been interesting
```{r group_accel}

accel_df %>% 
  group_by(
    day) %>%
  mutate(
    total_activity_per_day = sum(activity_count, na.rm = TRUE)
  ) %>% 
  ggplot(
    aes(x = day_id, y = total_activity_per_day, color = weekend)) + geom_point() + geom_smooth() + 
  labs(
    x = "Days",
    y = "Total Activity Per Day",
    title = "CHF Patient Activity Level Varies by Weekend and Stable by Weekday",
    caption = "Data came from five weeks of accelerometer data collected on a 63 year-old male with BMI 25, who was admitted to the Advanced Cardiac Care Center of Columbia University Medical Center and diagnosed with congestive heart failure (CHF)"
  )
```

The primary trend that is apparent is that the CHF patient has a higher overall activity level on weekdays relative to weekends. However, on Saturdays, activity levels drop and on Sundays activity levels are within range of weekday level activities, suggesting that Saturday is relatively a sedentary anomaly. 

  
_Office hour_ where i would put the na.rm true for this graph
```{r}
accel_df %>% 
  group_by(day) %>% 
  ggplot(aes(x = day_id, y = activity_count, color = day)) + 
  geom_point(alpha = .3) + geom_smooth(se = FALSE) +
  labs(
    x = "Days",
    y = "Activity Counts",
    title = "CHF Patient Activity Level Over time")
  
```

The primary trend is that in some cases, particularly on Saturdays, it looks like the accelerometer was not or was hardly worn. Other than that, in reality, some Saturdays the patient did appear to be active. Wednesdays and Fridays do appear to be mroe consistently active than other times. 


## Problem 3

```{r, echo = FALSE}
library(p8105.datasets)
data("ny_noaa")
```

```{r}
ny_noaa %>% 
  group_by(id) %>%
  filter(
      is.na(prcp),
      is.na(snow),
      is.na(snwd),
      is.na(tmax),
      is.na(tmin)) %>% 
  summarize(
  across(prcp:tmin, n_distinct)) %>% 
  arrange(prcp, snow, snwd, tmax, tmin)

```

There are `r nrow(ny_noaa)` observations and `r ncol(ny_noaa)` variables. Specifically, there is weather data, such as the ID, the date, the preceipitation, snow, snow and wind, max temperature and minimum temperature.In terms of missing data, however, it appears that the missing observeations are evenly distributed. 

_OfficeHours q_ how to then inspect whether there are any other missings, proportions of missing to not missing potential. Find out if assessment of missing data per & code makes sense 


```{r, echo = FALSE}
ny_noaa_tidy = 
  ny_noaa %>%
  janitor::clean_names() %>%
  separate(date, into = c("year", "month", "day"), sep = "-") %>% 
  mutate(
    year = as.integer(year),
    month = as.factor(month),
    day = as.integer(day),
    snow = as.numeric(snow),
    prcp = as.numeric(prcp),
    snwd = as.numeric(snwd),
    tmin = as.numeric(tmin),
    tmax = as.numeric(tmax)
  )
```


```{r}

ny_noaa_tidy %>% 
  drop_na(snow) %>% 
  mutate(
    rank_snow = min_rank(snow)
  ) %>% 
  select(id, year, month, day, snow, rank_snow) %>%
  ggplot(aes(x = rank_snow)) + geom_histogram()

```



